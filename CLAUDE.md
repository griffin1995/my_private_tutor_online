# üî¥ CRITICAL DEVELOPMENT STANDARDS - MANDATORY COMPLIANCE

## ‚ö†Ô∏è TIER 0: ABSOLUTE NON-NEGOTIABLES - ZERO TOLERANCE VIOLATIONS
These rules override ALL other considerations. Violation results in immediate task termination.

### üîí Documentation Sovereignty - ALL CODE CHANGES
- **CONTEXT7 MCP EXCLUSIVE**: ALL documentation via `mcp__context7__resolve-library-id` ‚Üí `mcp__context7__get-library-docs` ONLY
- **ZERO EXTERNAL SOURCES**: No blogs, tutorials, Stack Overflow, GitHub issues, community examples, or unofficial documentation
- **MANDATORY SOURCE ATTRIBUTION**: Every implementation, revision, modification, update, refactoring, and bug fix requires Context7 source comments
- **ALL REVISIONS MANDATE**: Not just new code - EVERY single code change must be backed by Context7 MCP official documentation
- **ZERO TOLERANCE POLICY**: No code changes based on "common knowledge", memory, assumptions, or quick fixes without official documentation backing

### üéØ Agent Orchestration Protocol
- **HAIKU**: Simple updates, CSS changes, content modifications, basic fixes
- **SONNET**: Complex components, API integration, forms, state management, testing
- **OPUS**: Architecture, performance, accessibility, security, business logic
- **NO MANUAL OVERRIDE**: If an agent should handle it, delegate it - no exceptions

### üá¨üáß Quality Standards
- **BRITISH ENGLISH MANDATORY**: All spelling, terminology, and conventions
- **PREMIUM SERVICE STANDARD**: Royal client-worthy implementations only
- **NO SHORTCUTS**: Enterprise-grade, production-ready solutions exclusively
- **ZERO AI ATTRIBUTION**: Never mention AI assistance in any form

## ‚ö° TIER 1: IMPLEMENTATION WORKFLOW

### üìã Pre-Development Checklist
1. Identify appropriate agent for task complexity
2. Retrieve Context7 MCP documentation for all dependencies
3. Verify implementation patterns against official docs
4. Prepare agent context with relevant documentation

### üîÑ MANDATORY DEVELOPMENT PROCESS FOR ALL CODE CHANGES
EVERY code change (new implementations, revisions, updates, refactoring, bug fixes) MUST follow:

1. **Context7 Resolution**: `mcp__context7__resolve-library-id` for library identification
2. **Documentation Retrieval**: `mcp__context7__get-library-docs` for official patterns  
3. **Pattern Verification**: Confirm exact official approach for the specific change needed
4. **Agent Delegation**: Route to appropriate agent with Context7 documentation
5. **Implementation/Revision**: Follow official patterns with mandatory source comments
6. **Verification**: Ensure Context7 compliance and source attribution for ALL changes

### üö® PRE-CHANGE VALIDATION CHECKLIST
Before making ANY code modification:
- [ ] Context7 MCP documentation retrieved for relevant libraries
- [ ] Official pattern identified for the specific change type
- [ ] Exact documentation section/version noted for citation
- [ ] Logic justification prepared based on official guidance  
- [ ] Comment format prepared with Context7 source and reasoning

### üìÅ File Management Protocol
- **PRECISION SCOPE**: Execute exactly what's requested, nothing more
- **EDIT-FIRST POLICY**: Prefer modifying existing files over creating new ones
- **NO PROACTIVE DOCS**: Only create documentation when explicitly requested
- **NECESSITY GATE**: New files only when absolutely essential for goal achievement

## üéØ TIER 2: CONTEXT7 MCP INTEGRATION

### üîç Documentation Retrieval Strategy
```
MANDATORY WORKFLOW:
1. mcp__context7__resolve-library-id(libraryName: "target-library")
2. mcp__context7__get-library-docs(context7CompatibleLibraryID: "/resolved/id")
3. Implement following official patterns only
4. Add Context7 source comments to all implementations
```

### üìù MANDATORY REVISION COMMENT STANDARDS
ALL code changes (implementations, revisions, modifications, updates, refactoring, bug fixes) MUST include Context7 source citations:

```typescript
// CONTEXT7 SOURCE: /radix-ui/primitives - Button with asChild pattern for polymorphic components
// REVISION REASON: Official Radix UI documentation Section 3.2 recommends Slot pattern for multiple children handling
// CONTEXT7 SOURCE: /framer/motion - LazyMotion configuration without strict mode
// BUG FIX REASON: Official Framer Motion docs v10.16.1 specify strict:false prevents React.Children.only errors
// CONTEXT7 SOURCE: /vercel/next.js - App Router dynamic rendering patterns
// REFACTOR REASON: Next.js 15.0 documentation mandates force-dynamic in layout.tsx for client-side routing
```

### üîç REVISION COMMENT FORMAT (MANDATORY)
Every code change, including single-line modifications, MUST include:
1. **CONTEXT7 SOURCE**: `/library/project - specific pattern/feature name`
2. **CHANGE TYPE**: Implementation/Revision/Update/Refactoring/Bug Fix + REASON
3. **DOCUMENTATION REFERENCE**: Exact section, version, or specific guidance followed
4. **LOGIC JUSTIFICATION**: WHY this approach based on official documentation

### üö´ FORBIDDEN SOURCES FOR ALL CODE CHANGES
ZERO TOLERANCE - These sources are NEVER acceptable for ANY code change:
- External documentation websites (even official ones outside Context7 MCP)
- Community tutorials or blog posts
- Stack Overflow or GitHub issue solutions  
- Unofficial examples or implementations
- General knowledge, memory, or assumptions
- "Quick fixes" without documentation backing
- "Common patterns" without official source
- Previous experience or industry standards without Context7 verification

### ‚ö†Ô∏è REVISION ENFORCEMENT RULES
- **SINGLE LINE CHANGES**: Even one-character modifications require Context7 documentation
- **CSS TWEAKS**: All styling changes must reference official framework documentation
- **BUG FIXES**: Must cite official troubleshooting or error handling patterns
- **REFACTORING**: Must reference official best practices for the specific transformation
- **PERFORMANCE OPTIMISATION**: Must cite official performance guidelines
- **ACCESSIBILITY FIXES**: Must reference WCAG guidelines via Context7 MCP

## üèõÔ∏è TIER 3: AGENT SPECIALISATION MATRIX

### ‚ö° Haiku Agent (Fast, Efficient)
**Optimal For**: Content updates, CSS tweaks, simple component changes, documentation updates, bug fixes
**Context Required**: Minimal - current file context, specific change requirements, AND relevant Context7 MCP documentation
**MANDATORY**: ALL changes require Context7 documentation retrieval and source comments
**Output Expected**: Quick, precise modifications with Context7 source comments and change reasoning

### ‚öñÔ∏è Sonnet Agent (Balanced, Complex)
**Optimal For**: Component architecture, API integrations, form implementations, state management, testing suites
**Context Required**: Moderate - relevant Context7 docs, component relationships, business requirements
**MANDATORY**: ALL implementations, modifications, and refactoring require Context7 MCP documentation
**Output Expected**: Well-structured implementations following official patterns with comprehensive source citations

### üß† Opus Agent (Advanced, Strategic)
**Optimal For**: System architecture, performance optimisation, accessibility compliance, security implementations, complex business logic
**Context Required**: Comprehensive - full Context7 documentation, system architecture, business context
**MANDATORY**: ALL architectural decisions, optimisations, and security implementations require Context7 MCP backing
**Output Expected**: Enterprise-grade solutions with detailed Context7 pattern justification and extensive source documentation

## üîß TIER 4: WORKFLOW OPTIMISATION

### üìä Task Classification
- **Simple** ‚Üí Haiku ‚Üí Quick execution with minimal context
- **Complex** ‚Üí Sonnet ‚Üí Structured implementation with moderate context
- **Strategic** ‚Üí Opus ‚Üí Comprehensive solution with full context

### üéØ Context Preparation
- Retrieve all relevant Context7 MCP documentation before agent invocation
- Prepare project-specific requirements and constraints
- Include business context for premium tutoring service standards
- Specify British English and royal client quality expectations

### ‚úÖ OUTPUT VERIFICATION - CONTEXT7 COMPLIANCE MANDATORY
EVERY code change must pass these verification checks:
- **Context7 MCP Pattern Compliance**: All changes follow official documentation patterns
- **Mandatory Source Comments**: Context7 source citations present for ALL modifications
- **Documentation Traceability**: Logic can be traced back to specific official guidance
- **Change Type Documentation**: Clear reasoning for revision/update/refactoring approach
- **British English Usage**: Consistent throughout all implementations
- **Premium Service Standards**: Royal client-worthy quality maintained

### üî¥ IMMEDIATE TERMINATION CONDITIONS
These violations result in immediate task termination:
- Any code change without Context7 MCP documentation backing
- Missing source comments on any modification (including single-line changes)  
- Use of external sources, tutorials, or "common knowledge" for implementation decisions
- Quick fixes or shortcuts without official documentation verification
- Assumptions about best practices without Context7 MCP confirmation

---

# üéì PROJECT: MY PRIVATE TUTOR ONLINE - PREMIUM REDESIGN 2025

## üéØ PROJECT CONTEXT
**Business**: Premium tutoring service with royal endorsements, serving elite families
**Heritage**: 15 years established (2010), featured in Tatler Address Book 2025
**Standards**: Royal client quality, enterprise-grade implementations, British English

## üìä CURRENT STATUS - PRODUCTION READY
‚úÖ **Vercel Deployment**: Dynamic rendering configured  
‚úÖ **React.Children.only**: Radix UI Slot patterns resolved  
‚úÖ **Content Updates**: Royal endorsement branding implemented  
‚úÖ **Video Assets**: All paths optimised in /public/videos/  
‚úÖ **Trust Indicators**: Updated with 2025 recognition content  

## üéØ TARGET DEMOGRAPHICS
- **Oxbridge Prep**: Affluent families, prestigious university entry
- **11+ Parents**: Grammar school preparation, reassurance-focused
- **A-Level/GCSE**: Immediate solutions, results-driven
- **Elite Corporate**: Ultra-wealthy, discretion required, bespoke service
- **Comparison Shoppers**: Logic-driven, service comparison analysis

## ‚ö° TECHNICAL SPECIFICATIONS
- **Performance**: <1.5s load times, Core Web Vitals optimised
- **Design**: Mobile-first responsive, accessibility WCAG 2.1 AA
- **Architecture**: Next.js 15+ App Router, React 19, TypeScript 5.3+
- **Features**: Booking system, progress tracking, payment integration

---

# üèóÔ∏è TECHNICAL IMPLEMENTATION STANDARDS

## üöÄ Architecture Foundation
- **Tech Stack**: Next.js 15+ App Router, React 19, TypeScript 5.3+, Tailwind CSS 4.x
- **State Management**: Zustand for client state, React Server Components for data
- **Form Handling**: React Hook Form + Zod validation, accessibility-first
- **Performance**: LCP <2.5s, FID <100ms, CLS <0.1, bundle <150kB gzipped

## üé® Design System & UI
- **Colour Scheme**: Navy (#0f172a), Gold accent (#eab308), white backgrounds
- **Typography**: Font-serif headings, font-sans body, consistent hierarchy
- **Component Libraries**: Radix UI + Tailwind (Shadcn/UI), accessibility-first selection
- **Variants**: Class Variance Authority (CVA) for component styling
- **Tokens**: Centralised design tokens for spacing, colours, typography

## üìä Content Management System
- **Architecture**: Centralised CMS via cms-content.ts and cms-images.ts
- **Zero Hardcoding**: All content, images, contact details via CMS
- **Comment Standard**: `// CMS DATA SOURCE: Using [function] for [purpose]`
- **Configuration**: settings.json for global config, structured metadata

## ‚ôø Accessibility & UX (WCAG 2.1 AA Mandatory)
- **Motion Sensitivity**: `prefers-reduced-motion` support required
- **Keyboard Navigation**: Complete keyboard accessibility, focus management
- **Semantic HTML**: Proper heading hierarchy, ARIA labels, semantic elements
- **Testing**: axe-core integration, automated accessibility validation

## üîß Quality Assurance
- **Testing Stack**: Vitest (unit), Playwright (E2E), axe-core (accessibility)
- **Performance**: Bundle analysis, Web Vitals tracking, real user monitoring
- **Security**: JWT authentication, HTTP-only cookies, Zod input validation
- **Documentation**: Common issues and solutions in codebase

## üìê Component Standards
- **Architecture**: PageLayout ‚Üí PageHero ‚Üí Section structure
- **Background Control**: Explicit background='white' in PageLayout
- **Responsive Design**: Mobile-first, proper breakpoint strategy
- **Pattern Documentation**: CUSTOM_DOCS.md for proven implementations

## üîÑ Development Workflow
- **Version Control**: Conventional commits, logical change grouping
- **Branch Strategy**: Main/develop/feature model for production service
- **Deployment**: Complete checklist with security review
- **Admin Experience**: User-friendly interfaces with comprehensive guides

---

# üöÄ PRODUCTION DEPLOYMENT PATTERNS - AUGUST 2025

## ‚ö° Vercel Dynamic Architecture (Proven Solution)
- **Global Force-Dynamic**: `export const dynamic = 'force-dynamic'` in layout.tsx only
- **Client Components**: All pages use "use client" directive for Framer Motion compatibility
- **No Page-Level Export**: Avoid redundant force-dynamic exports in individual pages
- **Static Export Removal**: Eliminate all static export configurations from next.config.ts

## üîß React.Children.only Resolution (Radix UI Patterns)
```typescript
// CONTEXT7 SOURCE: /radix-ui/primitives - Slot composition pattern
import { Root as Slot, Slottable } from "@radix-ui/react-slot"

// Multiple children handling
{asChild ? (
  <Slot>
    <Slottable>{children}</Slottable>
  </Slot>
) : (
  children
)}
```

## üéØ Component Architecture Standards
- **Modular Sections**: Extract homepage sections (ResultsSection, HomepageHowItWorks)
- **Flexible Props**: title, description, backgroundColor, className with sensible defaults
- **Context7 Comments**: Every component includes MCP documentation references
- **Semantic Selection**: Image mapping based on content context, not rotation

## üìä Performance Validation
- **Bundle Size**: First Load JS ~229kB homepage, build time <15 seconds
- **Routing**: All routes ∆í (Dynamic) server-rendered on demand
- **Video Assets**: All served from /public/videos/ with CMS integration
- **Section Spacing**: Consistent padding prevents double spacing

## üîÑ Deployment Protocol
- **Build Verification**: `npm run build` locally before deployment
- **Production Deploy**: `vercel --prod` for production releases
- **Cache Issues**: Delete/recreate Vercel project if persistent problems
- **Production URL**: https://my-tutor-website-6aipxnfeh-jacks-projects-cf5effed.vercel.app

---

# üìö CUSTOM PATTERN LIBRARY - MAINTAIN IN CUSTOM_DOCS.md
Document all Context7-verified patterns for rapid implementation reference.